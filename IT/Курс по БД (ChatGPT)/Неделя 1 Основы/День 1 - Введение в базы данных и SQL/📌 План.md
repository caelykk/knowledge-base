## **Новый Курс: "Базы Данных для Разработчиков на Python"**

---

### **Глава 1: Введение в Базы Данных**

#### **Теория**

##### **Тема 1: Что такое база данных (БД) и система управления базами данных (СУБД)**

- Определение БД: структурированное хранилище данных.
- Определение СУБД: программное обеспечение для управления БД.
- Примеры использования БД:
- Интернет-магазины: хранение данных о книгах, авторах, заказах и пользователях.
- Социальные сети: хранение профилей пользователей, постов, комментариев.
- Системы бронирования билетов: хранение информации о рейсах и местах.
##### **Тема 2: Типы баз данных**
- **Реляционные (SQL):** MySQL, PostgreSQL.
- Пример: таблицы `books`, `authors`, `orders`.
- **Нереляционные (NoSQL):** MongoDB, Redis, Elasticsearch, временные ряды (TimescaleDB), графовые БД (Neo4j).
- Пример: кэширование данных о популярных книгах в Redis.
- **Гибридные решения:** PostgreSQL с JSONB для хранения метаданных книг.

##### **Тема 3: ACID-свойства**
- Атомарность: заказ книги либо полностью выполняется, либо отменяется.
- Согласованность: данные о заказах всегда корректны.
- Изолированность: одновременные заказы не конфликтуют.
- Долговечность: данные сохраняются даже при сбоях.

##### **Тема 4: CAP-теорема**
- Выбор между консистентностью (например, точное количество книг в наличии) и доступностью (быстрый доступ к данным).
- Примеры систем, которые выбирают разные компромиссы (например, Cassandra vs. MySQL).

##### **Тема 5: История развития баз данных**
- От файловых систем к современным СУБД.
- Эволюция реляционных и нереляционных БД.

##### **Как выбрать подходящую СУБД для проекта**
- Критерии выбора: производительность, масштабируемость, стоимость, поддержка.

#### **Практика**

2. Установка MySQL и Django.
3. Создание базы данных `bookstore` в MySQL.
4. Настройка Django для работы с MySQL.
5. Создание первой таблицы `books` с полями:
    - `id`, `title`, `author`, `price`, `stock`.
6. Выполнение простых SQL-запросов:
    - Добавление данных: `INSERT INTO books (title, author, price, stock) VALUES ('Война и мир', 'Лев Толстой', 700, 10);`
    - Чтение данных: `SELECT * FROM books;`

---

## **Глава 2: Реляционные Базы Данных и SQL**

### **Теория**

7. **Язык SQL:**
    - Основные команды: `SELECT`, `INSERT`, `UPDATE`, `DELETE`.
    - Пример: выборка всех книг с ценой ниже 500 рублей:

        ```sql
		SELECT * FROM books WHERE price < 500;
		```
        
8.  **Нормализация:**
    - **1NF:** Удаление дублирующихся данных (например, список авторов в одной строке).
    - **2NF:** Создание отдельной таблицы `authors` для хранения информации об авторах.
    - **3NF:** Удаление зависимостей между неключевыми атрибутами (например, адрес издательства вынесен в отдельную таблицу).
    - Антинормализация: случаи, когда денормализация полезна для повышения производительности.
9. **Индексация:**
    - Пример: создание индекса для быстрого поиска книг по названию:
        ```sql
		CREATE INDEX idx_title ON books(title);
		```
    -  Объяснение влияния индексов на производительность запросов и их недостатки.
10. **Транзакции:**
    - Пример: оформление заказа:
        ```sql
		BEGIN;
		UPDATE books SET stock = stock - 1 WHERE id = 1;
		INSERT INTO orders (user_id, book_id, quantity) VALUES (1, 1, 1);
		COMMIT;
		```
    - 1.  Уровни изоляции транзакций: READ UNCOMMITTED, READ COMMITTED, REPEATABLE READ, SERIALIZABLE.
    - Конкурентный доступ и блокировки.
    - Примеры deadlock'ов и способы их предотвращения.
11. **Продвинутые темы:**
    - Оконные функции (`OVER`, `PARTITION BY`).
    - CTE (Common Table Expressions).

### **Практика**

12. Написание сложных SQL-запросов:
    - Пример: найти все книги определенного автора:
      ```sql
        SELECT b.title
        FROM books b
        JOIN authors a ON b.author_id = a.id
        WHERE a.name = 'Лев Толстой';
		```
13. Нормализация таблиц до 3NF.
14. Создание индексов и анализ производительности запросов с помощью `EXPLAIN`.

---

## **Глава 3: Проектирование Баз Данных**

### **Теория**

15. **ER-диаграммы:**
    - Что такое ER-диаграммы и как они помогают визуализировать структуру базы данных.
    - Пример ER-диаграммы для интернет-магазина книг.
16. **Выбор первичных и внешних ключей:**
    - Как правильно выбирать первичные ключи.
    - Использование внешних ключей для связывания таблиц.
17. **Проектирование схемы для интернет-магазина:**
    - Таблицы `users`, `orders`, `books`, `authors`.
18. **Денормализация:**
    - Когда и зачем использовать денормализацию (например, для аналитических запросов).

### **Практика**

19. Создание ER-диаграммы для интернет-магазина.
20. Реализация схемы базы данных в MySQL.

---

## **Глава 4: ORM (Object-Relational Mapping)**

### **Теория**

21. **Django ORM:**
    - Модели для таблиц `Book`, `Author`, `Order`.
    - Пример модели:
      ```python
      class Book(models.Model):  
        title = models.CharField(max_length=255)
        author = models.ForeignKey(Author, on_delete=models.CASCADE)
        price = models.DecimalField(max_digits=10, decimal_places=2)
        stock = models.IntegerField()
		```
        

        
22. 1. **Оптимизация запросов:**
    - `select_related`: выборка связанных данных (например, авторов книг).
    - `prefetch_related`: выборка связанных данных для множественных отношений (например, отзывы к книгам).
    - N+1 проблема и её решение.
23. **Raw SQL в Django ORM:**
    - Пример использования raw SQL для сложных запросов.
24. **Миграции:**
    - Как работать с конфликтами миграций.
    - Лучшие практики написания миграций.
25. **QuerySet API:**
    - Оптимизация запросов с использованием `annotate`, `aggregate`.
26. **Сериализация данных для API:**
    - Использование Django REST Framework для создания API.
    - Пагинация и фильтры.

### **Практика**

27. Создание моделей для интернет-магазина.
28. Оптимизация запросов с помощью `select_related` и `prefetch_related`.
29. Создание миграций и их применение.
30. Реализация API с использованием Django REST Framework.

---

## **Глава 5: Производительность и Оптимизация**

### **Часть 1: Оптимизация SQL-запросов**

31. **Анализ планов выполнения запросов:**
    - Использование `EXPLAIN` для анализа запросов.
32. **Индексация:**
    - Типы индексов: B-tree, Hash, Full-text.
    - Примеры применения различных типов индексов.

### **Часть 2: Масштабирование базы данных**

33. **Репликация:**
    - Настройка мастер-слейв репликации для MySQL.
    - Типы репликации и их преимущества.
    - Конфликты при записи в реплики.
34. **Шардирование и партиционирование данных:**
    - Пример шардирования таблицы `orders`.
35. **Очереди задач:**
    - Использование Celery для обработки фоновых операций.

### **Практика**

36. Анализ производительности запросов с помощью `EXPLAIN`.
37. Настройка репликации в MySQL.
38. Реализация шардирования данных.
39. Настройка Celery для обработки фоновых задач.

---

## **Глава 6: Безопасность и Администрирование**

### **Теория**

40. **Защита данных:**
    - RBAC: роли пользователей (администратор, клиент).
    - Защита от SQL-инъекций, XSS, CSRF.
    - Защита от DoS/DDoS атак.
    - Шифрование данных (например, Transparent Data Encryption в MySQL).
    - Использование SSL/TLS для защиты соединений.
41. **Резервное копирование:**
    - Автоматическое создание бэкапов базы данных.
    - Разница между логическими и физическими бэкапами.
42. **Аудит базы данных:**
    - Лучшие практики аудита.

### **Практика**

43. Настройка прав доступа в MySQL.
44. Создание автоматических бэкапов.
45. Защита приложения от SQL-инъекций.
46. Настройка защиты от DoS/DDoS атак.

---

## **Глава 7: Современные Тренды и Облачное Развертывание**

### **Теория**

47. **Облачные базы данных:**
    - Amazon RDS для MySQL.
    - AWS Elasticache для Redis.
48. **Стриминговые платформы:**
    - Apache Kafka для обработки событий (например, уведомления о новых заказах).
    - Партиционирование и отказоустойчивость в Kafka.
49. **Kubernetes и Terraform:**
    - Kubernetes для управления контейнерами.
    - Terraform для автоматизации развертывания инфраструктуры.
50. **Elasticsearch:**
    - Полноценный текстовый поиск.
    - Интеграция Elasticsearch с Django.

### **Практика**

51. Развертывание базы данных в AWS RDS.
52. Реализация стриминга данных с Apache Kafka.
53. Настройка Kubernetes и Terraform.
54. Интеграция Elasticsearch с Django.

---

## **Глава 8: Мониторинг и Обслуживание**

### **Теория**

55. **Мониторинг производительности:**
    - Использование Prometheus и Grafana для мониторинга базы данных.
    - ELK-стек (Elasticsearch, Logstash, Kibana) для анализа логов.
56. **Ротация логов:**
    - Настройка ротации логов для MySQL.
57. **Планы восстановления после сбоев:**
    - Разработка планов восстановления данных.

### **Практика**

58. Настройка мониторинга с Prometheus и Grafana.
59. Настройка ELK-стека для анализа логов.
60. Настройка ротации логов.
61. Тестирование планов восстановления.

---

## **Глава 9: Большие Данные и Нагрузочное Тестирование**

### **Теория**

62. **Большие данные:**
    - Использование Apache Spark или Hadoop.
    - Временные ряды (TimescaleDB).
63. **Нагрузочное тестирование:**
    - Использование JMeter или Locust.
    - Примеры нагрузочного тестирования API.

### **Практика**

64. Настройка Apache Spark для анализа больших данных.
65. Нагрузочное тестирование API с использованием JMeter или Locust.

---

## **Заключение: Проектная Работа**

### **Требования**

66. Разработка интернет-магазина книг с использованием:
    - Django + MySQL.
    - Redis для кэширования.
    - AWS для облачного развертывания.
67. Реализация CRUD-операций:
    - Добавление, редактирование и удаление книг, авторов, заказов.
68. Оптимизация производительности:
    - Индексация, кэширование.
69. Настройка безопасности:
    - RBAC, защита от SQL-инъекций.
    - Автоматическое резервное копирование.
70. Тестирование и документация:
    - Использование pytest для тестирования моделей Django.
    - Документация API и базы данных.

---

## **Дополнительные Материалы**

71. **Литература:**
    - "High Performance MySQL" by Baron Schwartz.
    - "Designing Data-Intensive Applications" by Martin Kleppmann.
    - "SQL Antipatterns" by Bill Karwin.
    - "Database Internals" by Alex Petrov.
72. **Видеоуроки:**
    - Серия лекций по Django и MySQL.
    - MIT OpenCourseWare — базы данных.
    - Канал "Academind" на YouTube.
73. **Инструменты:**
    - DBeaver, pgAdmin, Redis CLI.
    - Metabase для визуализации данных.