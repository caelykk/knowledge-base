### **Что такое SFTP**

SFTP расшифровывается как Secure File Transfer Protocol. Также букву S можно понимать как SSH, так как SFTP работает с использованием именно этого протокола.

[Что такое протокол SSH](https://selectel.ru/blog/what-is-ssh/)

Порядок работы SFTP следующий:

1. Клиент отправляет запрос на передачу данных на сервер по порту 22. Этот порт используется для безопасного соединения SSH между узлами сети. 
2. Сервер принимает запрос и шифрует необходимые запрашиваемые данные с помощью SSH.
3. Сервер отправляет данные клиенту.
4. Клиент принимает данные и, используя аутентификацию SSH, расшифровывает их для дальнейшего использования.

### Преимущества использования SFTP

Самое очевидное преимущество SFTP перед предшественниками — это, конечно же, безопасность и конфиденциальность. Нельзя сказать, что данные, передаваемые с использованием протокола SFTP, невозможно украсть, но сделать это очень сложно.

Среди других преимуществ SFTP можно выделить:
- приостановку и возобновление передачи данных,
- полную остановку передачи данных,
- возможность выполнение базовых команд администрирования (примеры использования некоторых команд мы покажем ниже),
- передачу вместе с файлами их метаданных.


### Использование SSH (Secure Shell)

SSH внутри протокола SFTP обеспечивает следующие функции:

- **Аутентификация клиента и сервера.** SSH производит аутентификацию на основе пары ключей — открытого и закрытого. Это позволяет точно определить, что клиент, запрашивающий подключение к серверу, является легитимным.
- **Шифрование данных.** RSA, DSA и другие типы шифрования — выбирайте на свой вкус. По умолчанию SSH и SFTP используют RSA. Даже обеспечивая аутентификацию, необходимо шифровать передаваемые данные, чтобы при краже их было почти невозможно прочитать.
- **Передача данных через единственный порт.** Обычный FTP может передавать данные через множество портов. SFTP же, в свою очередь, поддерживает передачу лишь по одному порту. По умолчанию это порт 22, но вы можете изменить его на любой доступный. Ограничение количества портов необходимо для того, чтобы снизить вероятность атаки MITM (человек посередине) путем снижения точек, возможных для прослушивания.

Все это позволяет добиться минимизации шансов взлома сессии злоумышленниками.

### Сравнение с FTPS

- FTPS (использует SSL/TLS) является более простым в использовании, но в то же время менее надежным для защиты свои данные. В свою очередь SFTP (использует SSH) более надежен, но его настройка занимает больше времени. Настоятельно рекомендуется использовать именно SFTP, так как он обеспечивает более надежную защиту.

- SFTP использует лишь один порт для передачи всего трафика между узлами. В то время как FTPS задействует как минимум два: один для инициализации связи между узлами и управления, второй — для передачи данных.

- При каждом последующем запросе данных FTPS будет открывать новый порт для передачи. Это приводит к блокировкам брандмауэра, так как он не может определить цель только что открытого порта (из-за использования SSL/TLS). Брандмауэр блокирует порт для передачи данных. Конечно, можно вручную открывать каждый порт в настройках брандмауэра или делать это сразу для некоторого диапазона, но не думаем, что вам хотелось бы заниматься этим каждый раз при обращении к серверу.